{% extends 'core/base.html'  %}
{% load crispy_forms_tags %}
{% load humanize %}

{% block upperscript%}
(<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>)
<link rel="stylesheet" href="https://unpkg.com/bulma@0.9.0/css/bulma.min.css" />
    <script src="https://kit.fontawesome.com/7dc3015a44.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>

<style>

.is-shady {
animation: flyintoright .4s backwards;
background: #fff;
box-shadow: rgba(0, 0, 0, .1) 0 1px 0;
border-radius: 4px;
display: inline-block;
margin: 10px;
position: relative;
transition: all .2s ease-in-out;
}
.is-shady:hover {
box-shadow: 0 10px 16px rgba(0, 0, 0, .13), 0 6px 6px rgba(0, 0, 0, .19);
}
</style>

<style>
    input[type="radio"], .tab-pane { display: block; }

/* the magic */
#complaint:checked ~ .tab-content > .content-complaint,
#feedback:checked ~ .tab-content > .content-feedback {
  display: block;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="columns">
      <div class="column is-6 is-half is-offset-one-quarter">
          <h1 class="title">Complaints & Request</h1>

<a href = "{% url 'make_complaint' %}" >


               <button type="submit" class="button is-primary" style="position:absolute; top: 5%;left: 63%;">Create a Complaint</button></a>
        <div class="container" id ="studysocioprofileapp">


    {% if messages %}
<ul class="messages">
    {% for message in messages %}

    {% if message.tags == 'warning' %}
    <div  class= "notification is-danger" id="msg">
   {{ message }}
    </div>
     {% else %}
    <div  class="notification is-success" id="msg">
     {{ message }}
    </div>
   {% endif %}
    {% endfor %}
</ul>
{% endif %}
<div id="vueapp">

<!-- Nav tabs -->
<div class="tabs">
  <ul>
    <li v-bind:class="{ 'is-active': tabsel == 'complaint' }" @click="tabsel = 'complaint'"><a>Complaints & Request ({{ view_Complaint.count }})</a></li>
    <li v-bind:class="{ 'is-active': tabsel == 'feedback' }" @click="tabsel = 'feedback'"><a>Feedback ({{feedbacks.count}})</a></li>
  </ul>
</div>

<!-- Tab panes -->
<div class="content">
  <div v-show="tabsel == 'complaint'">
      {% for k in view_Complaint %}
                    <div class="card">
                        <div class="card-content">
                            <div class="content">
                                <p class="title is-5"><b>{{k.title}}</b></p>
                                <p>{{k.Description}}</p>
                                <p class="level-right">{{k.created_at}}</p>
                            </div>
                        </div>
                    </div>
                    <br>
                    {% endfor %}
  </div>
  <div v-show="tabsel == 'feedback'">
      {% for x in feedbacks %}
                            <div class="card">
                                <div class="card-content">
                                    <div class="content">
                                        <p class="title is-6">
                                            <b>Regarding on : {{x.complaint.title}} posted on <span class="title is-7"><i>{{x.complaint.created_at}}</i></span></b></p>
                                        <p >{{x.Description}}</p>
                                        <p class="level-right"><i>{{x.created_at}}</i></p>
                                        <p>Thanking You <br>{{x.created_by}} @ Team Study-Socio</p>
                                    </div>
                                </div>
                            </div>
                            <br>
                            {% endfor %}
  </div>
</div>

</div>


      </div>
    </div>


      </div>
    </div>
</div>


{% endblock %}
{% block script %}
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
<script>

    if ( window.history.replaceState ) {
        window.history.replaceState( null, null, window.location.href );
    }
</script>
<script>
    setTimeout(function(){
        if ($('#msg').length > 0) {
            $('#msg').remove();
        }
    }, 3000)    // 3000 millisecond
</script>
 <script>
    document.querySelectorAll("#nav li").forEach(function(navEl) {
  navEl.onclick = function() { toggleTab(this.id, this.dataset.target); }
});

function toggleTab(selectedNav, targetId) {
  var navEls = document.querySelectorAll("#nav li");

  navEls.forEach(function(navEl) {
    if (navEl.id == selectedNav) {
      navEl.classList.add("is-active");
    } else {
      if (navEl.classList.contains("is-active")) {
        navEl.classList.remove("is-active");
      }
    }
  });

  var tabs = document.querySelectorAll(".tab-pane");

  tabs.forEach(function(tab) {
    if (tab.id == targetId) {
      tab.style.display = "block";
    } else {
      tab.style.display = "none";
    }
  });
}
</script>

<script>
    'use strict';

var app = new Vue({
  el: '#vueapp',
  data: {
    tabsel: "complaint"
  }
});
</script>

{% endblock %}